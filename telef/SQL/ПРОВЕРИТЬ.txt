Добавить проверку - добавились ли новые строки - в детализацию.
count(*) до сравнить с той что будет после 

Добавить второй оператор на проверку на дубликаты SH (добавлять IGNORE если есть второй ключ)


можно еще засунуть fill_cross проверку наработающего провайдера...
date_off>curr_date


поставить ключ на скрипт ./count-processing.sh (ДАТА) который сообщает нам о том чтоб он считал базу начиная только с этого(ДАТА) числа.